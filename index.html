<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®‰å…¨ãƒ‘ãƒˆãƒ­ãƒ¼ãƒ«ç‚¹æ¤œè¡¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Yu Gothic', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 3px solid #e9ecef;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab {
            flex: 1;
            min-width: 120px;
            padding: 18px 20px;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: #495057;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e9ecef;
            color: #667eea;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background: #138496;
            transform: translateY(-2px);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        .data-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .data-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
            font-size: 14px;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        .data-table tbody tr:last-child td {
            border-bottom: none;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-btn.edit {
            background: #ffc107;
            color: #000;
        }

        .action-btn.delete {
            background: #dc3545;
            color: white;
        }

        .action-btn:hover {
            transform: scale(1.05);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .inspection-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .inspection-category {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .inspection-category h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .inspection-item {
            display: grid;
            grid-template-columns: 60px 1fr 100px 200px;
            gap: 15px;
            align-items: center;
            padding: 12px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .inspection-item .item-no {
            font-weight: bold;
            color: #667eea;
            text-align: center;
            font-size: 16px;
        }

        .inspection-item .item-text {
            font-size: 14px;
            color: #495057;
        }

        .inspection-item select {
            padding: 8px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
        }

        .inspection-item input[type="text"] {
            padding: 8px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
        }

        .report-container {
            background: white;
            padding: 30px;
            margin-top: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .report-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .report-header h2 {
            font-size: 24px;
            color: #667eea;
            margin-bottom: 10px;
        }

        .report-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .report-info-item {
            font-size: 14px;
        }

        .report-info-item strong {
            color: #667eea;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            display: none;
        }

        .alert.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .modal-header {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #667eea;
        }

        .modal-footer {
            margin-top: 20px;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        @media (max-width: 768px) {
            .container {
                border-radius: 0;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 22px;
            }

            .tab {
                padding: 12px 10px;
                font-size: 13px;
                min-width: 100px;
            }

            .tab-content {
                padding: 15px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .inspection-item {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .report-info {
                grid-template-columns: 1fr;
            }

            .data-table {
                font-size: 12px;
            }

            .data-table th,
            .data-table td {
                padding: 8px;
            }
        }

        /* å°åˆ·ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        @media print {
            @page {
                size: A4;
                margin: 10mm;
            }

            body {
                background: white;
                padding: 0;
            }

            .container {
                max-width: 100%;
                box-shadow: none;
                border-radius: 0;
            }

            .header {
                background: white !important;
                color: black !important;
                padding: 10px 0;
                border-bottom: 2px solid #000;
            }

            .header h1 {
                color: black !important;
                text-shadow: none;
                font-size: 18px;
            }

            .header p {
                display: none;
            }

            .tabs,
            .btn,
            .action-buttons,
            .search-box,
            .filter-section,
            .inspection-form,
            #alert {
                display: none !important;
            }

            .tab-content {
                display: block !important;
                padding: 0;
            }

            .tab-content:not(#monthly) {
                display: none !important;
            }

            /* å°åˆ·ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚¿ã‚¤ãƒ« */
            .print-table {
                width: 100%;
                border-collapse: collapse;
                font-size: 9pt;
                margin-top: 10px;
            }

            .print-table th,
            .print-table td {
                border: 1px solid #000;
                padding: 4px 6px;
                text-align: left;
            }

            .print-table th {
                background-color: #f0f0f0 !important;
                font-weight: bold;
                text-align: center;
            }

            .print-table .item-no {
                text-align: center;
                width: 35px;
                font-weight: bold;
            }

            .print-table .item-text {
                font-size: 8.5pt;
            }

            .print-table .item-result {
                text-align: center;
                width: 40px;
            }

            .print-table .item-comment {
                width: 30%;
                font-size: 8pt;
            }

            .print-header {
                margin-bottom: 10px;
                font-size: 10pt;
            }

            .print-header table {
                width: 100%;
                border-collapse: collapse;
            }

            .print-header td {
                padding: 3px 8px;
                border: 1px solid #000;
            }

            .print-header .label {
                background-color: #f0f0f0;
                font-weight: bold;
                width: 80px;
            }

            .category-header {
                background-color: #e0e0e0 !important;
                font-weight: bold;
                text-align: center;
                padding: 5px !important;
            }

            /* ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã¯éè¡¨ç¤º */
            .data-table {
                display: none;
            }

            .modal {
                display: none !important;
            }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .empty-state p {
            font-size: 14px;
        }

        .search-box {
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
        }

        .filter-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ›¡ï¸ å®‰å…¨ãƒ‘ãƒˆãƒ­ãƒ¼ãƒ«ç‚¹æ¤œè¡¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
            <p>Safety Patrol Inspection Management System</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('construction')">å·¥äº‹ãƒã‚¹ã‚¿ãƒ¼</button>
            <button class="tab" onclick="switchTab('company')">ä¼šç¤¾ãƒã‚¹ã‚¿ãƒ¼</button>
            <button class="tab" onclick="switchTab('inspector')">å®Ÿæ–½è€…ãƒã‚¹ã‚¿ãƒ¼</button>
            <button class="tab" onclick="switchTab('inspection')">ç‚¹æ¤œè¡¨å…¥åŠ›</button>
            <button class="tab" onclick="switchTab('monthly')">æœˆæ¬¡ç‚¹æ¤œç°¿</button>
        </div>

        <div id="alert" class="alert"></div>

        <!-- å·¥äº‹ãƒã‚¹ã‚¿ãƒ¼ -->
        <div id="construction" class="tab-content active">
            <h2 style="margin-bottom: 20px; color: #667eea;">å·¥äº‹ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†</h2>
            
            <div class="inspection-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>å·¥äº‹å *</label>
                        <input type="text" id="constructionName" placeholder="å·¥äº‹åã‚’å…¥åŠ›">
                    </div>
                    <div class="form-group">
                        <label>ç¾å ´å</label>
                        <input type="text" id="siteName" placeholder="ç¾å ´åã‚’å…¥åŠ›">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å·¥äº‹å ´æ‰€</label>
                        <input type="text" id="location" placeholder="å·¥äº‹å ´æ‰€ã‚’å…¥åŠ›">
                    </div>
                    <div class="form-group">
                        <label>å·¥æœŸ</label>
                        <input type="text" id="period" placeholder="ä¾‹: 2024å¹´4æœˆ1æ—¥ï½2024å¹´9æœˆ30æ—¥">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="saveConstruction()">
                    <span id="constructionBtnText">ç™»éŒ²</span>
                </button>
                <button class="btn btn-secondary" onclick="clearConstructionForm()">ã‚¯ãƒªã‚¢</button>
            </div>

            <div class="search-box">
                <input type="text" id="constructionSearch" placeholder="ğŸ” å·¥äº‹åã§æ¤œç´¢..." onkeyup="searchConstruction()">
            </div>

            <table class="data-table" id="constructionTable">
                <thead>
                    <tr>
                        <th>No.</th>
                        <th>å·¥äº‹å</th>
                        <th>ç¾å ´å</th>
                        <th>å·¥äº‹å ´æ‰€</th>
                        <th>å·¥æœŸ</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="constructionTableBody"></tbody>
            </table>
        </div>

        <!-- ä¼šç¤¾ãƒã‚¹ã‚¿ãƒ¼ -->
        <div id="company" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">ä¼šç¤¾ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†</h2>
            
            <div class="inspection-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>ä¼šç¤¾å *</label>
                        <input type="text" id="companyName" placeholder="ä¼šç¤¾åã‚’å…¥åŠ›">
                    </div>
                    <div class="form-group">
                        <label>ä»£è¡¨è€…å</label>
                        <input type="text" id="representative" placeholder="ä»£è¡¨è€…åã‚’å…¥åŠ›">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>é›»è©±ç•ªå·</label>
                        <input type="tel" id="phone" placeholder="é›»è©±ç•ªå·ã‚’å…¥åŠ›">
                    </div>
                    <div class="form-group">
                        <label>ä½æ‰€</label>
                        <input type="text" id="address" placeholder="ä½æ‰€ã‚’å…¥åŠ›">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="saveCompany()">
                    <span id="companyBtnText">ç™»éŒ²</span>
                </button>
                <button class="btn btn-secondary" onclick="clearCompanyForm()">ã‚¯ãƒªã‚¢</button>
            </div>

            <div class="search-box">
                <input type="text" id="companySearch" placeholder="ğŸ” ä¼šç¤¾åã§æ¤œç´¢..." onkeyup="searchCompany()">
            </div>

            <table class="data-table" id="companyTable">
                <thead>
                    <tr>
                        <th>No.</th>
                        <th>ä¼šç¤¾å</th>
                        <th>ä»£è¡¨è€…å</th>
                        <th>é›»è©±ç•ªå·</th>
                        <th>ä½æ‰€</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="companyTableBody"></tbody>
            </table>
        </div>

        <!-- å®Ÿæ–½è€…ãƒã‚¹ã‚¿ãƒ¼ -->
        <div id="inspector" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">å®Ÿæ–½è€…ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†</h2>
            
            <div class="inspection-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>å®Ÿæ–½è€…å *</label>
                        <input type="text" id="inspectorName" placeholder="å®Ÿæ–½è€…åã‚’å…¥åŠ›">
                    </div>
                    <div class="form-group">
                        <label>æ‰€å±ä¼šç¤¾</label>
                        <select id="inspectorCompany">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å½¹è·</label>
                        <input type="text" id="position" placeholder="å½¹è·ã‚’å…¥åŠ›">
                    </div>
                    <div class="form-group">
                        <label>é€£çµ¡å…ˆ</label>
                        <input type="tel" id="contact" placeholder="é€£çµ¡å…ˆã‚’å…¥åŠ›">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="saveInspector()">
                    <span id="inspectorBtnText">ç™»éŒ²</span>
                </button>
                <button class="btn btn-secondary" onclick="clearInspectorForm()">ã‚¯ãƒªã‚¢</button>
            </div>

            <div class="search-box">
                <input type="text" id="inspectorSearch" placeholder="ğŸ” å®Ÿæ–½è€…åã§æ¤œç´¢..." onkeyup="searchInspector()">
            </div>

            <table class="data-table" id="inspectorTable">
                <thead>
                    <tr>
                        <th>No.</th>
                        <th>å®Ÿæ–½è€…å</th>
                        <th>æ‰€å±ä¼šç¤¾</th>
                        <th>å½¹è·</th>
                        <th>é€£çµ¡å…ˆ</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="inspectorTableBody"></tbody>
            </table>
        </div>

        <!-- ç‚¹æ¤œè¡¨å…¥åŠ› -->
        <div id="inspection" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">å®‰å…¨ãƒ‘ãƒˆãƒ­ãƒ¼ãƒ«ç‚¹æ¤œè¡¨å…¥åŠ›</h2>
            
            <div class="inspection-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>ç‚¹æ¤œæ—¥ *</label>
                        <input type="date" id="inspectionDate">
                    </div>
                    <div class="form-group">
                        <label>å·¥äº‹å *</label>
                        <select id="inspectionConstruction" onchange="updateSiteName()">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å®Ÿæ–½è€… *</label>
                        <select id="inspectionInspector">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>ç¾å ´å</label>
                    <input type="text" id="inspectionSiteName" readonly style="background: #f8f9fa;">
                </div>
            </div>

            <!-- å®‰å…¨è¡›ç”Ÿç®¡ç†ä½“åˆ¶ -->
            <div class="inspection-category">
                <h3>å®‰å…¨è¡›ç”Ÿç®¡ç†ä½“åˆ¶</h3>
                <div class="inspection-item">
                    <div class="item-no">1</div>
                    <div class="item-text">ç·Šæ€¥é€£çµ¡å…ˆãƒ»æ•‘æ€¥ç—…é™¢ãƒ»é¿é›£å ´æ‰€ï¼ˆåœ°å›³ï¼‰ã¯ã€ç›®ç«‹ã¤å ´æ‰€ã«æ²ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="1">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="1" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">2</div>
                    <div class="item-text">ä½œæ¥­å“¡åç°¿ãŒå…¨å“¡æå‡ºã•ã‚Œã¦ãŠã‚Šã€å†…å®¹ã«æ¼ã‚Œã¯ãªã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="2">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="2" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">3</div>
                    <div class="item-text">å®‰å…¨è¡›ç”Ÿæ—¥èªŒï¼ˆå®‰å…¨ä½œæ¥­æŒ‡ç¤ºæ›¸ï¼‰ã®ä½œæˆãƒ»è¨˜éŒ²ç®¡ç†ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="3">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="3" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">4</div>
                    <div class="item-text">ä½œæ¥­è¨ˆç”»æ›¸ãƒ»ä½œæ¥­æ‰‹é †æ›¸ã®ä½œæˆãƒ»å‘¨çŸ¥åŠã³è¨˜éŒ²ç®¡ç†ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="4">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="4" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">5</div>
                    <div class="item-text">é€ã‚Šå‡ºã—æ•™è‚²ã¯ã€å®Ÿæ–½ã•ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="5">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="5" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">6</div>
                    <div class="item-text">äº‹æ¥­ä¸»ãƒ»ä¸€äººè¦ªæ–¹ã¯ã€åŠ´ç½ä¿é™ºç‰¹åˆ¥åŠ å…¥ã‚’ã—ã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="6">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="6" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">7</div>
                    <div class="item-text">å¥åº·ç®¡ç†ï¼ˆå¥åº·è¨ºæ–­ãƒ»ç†±ä¸­ç—‡äºˆé˜²å¯¾ç­–ç­‰ï¼‰ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="7">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="7" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">8</div>
                    <div class="item-text">é«˜å¹´é½¢è€…ã®å°±æ¥­ç®¡ç†ãƒ»é©æ­£é…ç½®ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="8">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="8" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">9</div>
                    <div class="item-text">å¹´å°‘è€…ãƒ»å¥³æ€§ã®å°±æ¥­ç®¡ç†ãƒ»é©æ­£é…ç½®ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="9">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="9" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">10</div>
                    <div class="item-text">æœ‰è³‡æ ¼ä½œæ¥­ã§ã¯ã€æœ‰è³‡æ ¼è€…ãŒé©æ­£ã«é…ç½®ã•ã‚Œã¦ã€è³‡æ ¼è€…è¨¼ã‚’æºå¸¯ã—ã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="10">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="10" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">11</div>
                    <div class="item-text">æœç¤¼å‚åŠ ãƒ»ç¾åœ°KYãƒ»å§‹æ¥­å‰ç‚¹æ¤œã¯å®Ÿæ–½ã—ã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="11">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="11" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
            </div>

            <!-- å¢œè½ãƒ»è»¢è½ãƒ»é£›æ¥è½ä¸‹ç½å®³ -->
            <div class="inspection-category">
                <h3>å¢œè½ãƒ»è»¢è½ãƒ»é£›æ¥è½ä¸‹ç½å®³</h3>
                <div class="inspection-item">
                    <div class="item-no">12</div>
                    <div class="item-text">è„šç«‹ã®ä½¿ç”¨æ¡ä»¶ãƒ»ä½œæ¥­ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="12">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="12" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">13</div>
                    <div class="item-text">ç«‹ã¡é¦¬ç­‰å¯æ¬å¼ä½œæ¥­å°ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="13">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="13" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">14</div>
                    <div class="item-text">ã¯ã—ã”ã®ä½¿ç”¨æ¡ä»¶ãƒ»æ˜‡é™ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="14">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="14" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">15</div>
                    <div class="item-text">é«˜æ‰€ä½œæ¥­è»Šãƒ»ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¿ãƒ¯ãƒ¼ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="15">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="15" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">16</div>
                    <div class="item-text">é–‹å£éƒ¨é¤Šç”Ÿãƒ»è¡¨ç¤ºã‚„é–‹å£éƒ¨å‘¨è¾ºä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="16">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="16" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">17</div>
                    <div class="item-text">è¶³å ´ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="17">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="17" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">18</div>
                    <div class="item-text">ç‰æ›ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="18">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="18" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
            </div>

            <!-- é‡æ©Ÿç½å®³ -->
            <div class="inspection-category">
                <h3>é‡æ©Ÿç½å®³</h3>
                <div class="inspection-item">
                    <div class="item-no">19</div>
                    <div class="item-text">å»ºè¨­æ©Ÿæ¢°ï¼ˆã‚¯ãƒ¬ãƒ¼ãƒ³ãƒ»ãƒãƒƒã‚¯ãƒ›ãƒ¼ç­‰ï¼‰ã®ä½¿ç”¨å±ŠåŠã³ç‚¹æ¤œç®¡ç†ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="19">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="19" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">20</div>
                    <div class="item-text">æ˜å‰Šä½œæ¥­ï¼ˆãƒãƒƒã‚¯ãƒ›ãƒ¼ç­‰ï¼‰ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="20">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="20" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
            </div>

            <!-- é›»å‹•å·¥å…·ç½å®³ -->
            <div class="inspection-category">
                <h3>é›»å‹•å·¥å…·ç½å®³</h3>
                <div class="inspection-item">
                    <div class="item-no">21</div>
                    <div class="item-text">ãƒ‡ã‚£ã‚¹ã‚¯ã‚°ãƒ©ã‚¤ãƒ³ãƒ€ãƒ¼ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="21">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="21" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">22</div>
                    <div class="item-text">é«˜é€Ÿã‚«ãƒƒã‚¿ãƒ¼ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="22">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="22" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">23</div>
                    <div class="item-text">ã­ã˜åˆ‡ã‚Šæ—‹ç›¤ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="23">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="23" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">24</div>
                    <div class="item-text">ä¸¸ã®ã“ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="24">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="24" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">25</div>
                    <div class="item-text">é›»å‹•ãƒ‰ãƒªãƒ«ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="25">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="25" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">26</div>
                    <div class="item-text">ã‚¹ãƒ‘ã‚¤ãƒ©ãƒ«ã‚«ãƒƒã‚¿ãƒ¼ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="26">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="26" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
            </div>

            <!-- ç«ç½ãƒ»æ„Ÿé›»ç½å®³ -->
            <div class="inspection-category">
                <h3>ç«ç½ãƒ»æ„Ÿé›»ç½å®³</h3>
                <div class="inspection-item">
                    <div class="item-no">27</div>
                    <div class="item-text">ã‚¬ã‚¹æº¶æ¥ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="27">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="27" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">28</div>
                    <div class="item-text">ã‚¢ãƒ¼ã‚¯æº¶æ¥ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="28">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="28" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">29</div>
                    <div class="item-text">å·¥äº‹ç”¨åˆ†é›»ç›¤å–æ‰±ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="29">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="29" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
            </div>

            <!-- å±é™ºæœ‰å®³ä½œæ¥­ -->
            <div class="inspection-category">
                <h3>å±é™ºæœ‰å®³ä½œæ¥­</h3>
                <div class="inspection-item">
                    <div class="item-no">30</div>
                    <div class="item-text">æœ‰æ©Ÿæº¶å‰¤ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="30">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="30" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">31</div>
                    <div class="item-text">é…¸æ¬ å±é™ºä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="31">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="31" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">32</div>
                    <div class="item-text">çŸ³ç¶¿å–æ‰±ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="32">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="32" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
            </div>

            <!-- è¦å¾‹ãƒ»è¡›ç”Ÿç®¡ç† -->
            <div class="inspection-category">
                <h3>è¦å¾‹ãƒ»è¡›ç”Ÿç®¡ç†</h3>
                <div class="inspection-item">
                    <div class="item-no">33</div>
                    <div class="item-text">å®‰å…¨ä¿è­·å…·ã¯è¦æ ¼èªå®šå“ã§ã€ä½¿ç”¨å‰ç‚¹æ¤œã¯å®Ÿæ–½ã—ã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="33">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="33" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">34</div>
                    <div class="item-text">ä½œæ¥­å ´æ‰€ãƒ»åŠ å·¥å ´ãƒ»ä½œæ¥­é€šè·¯ã®ç¢ºä¿åŠã³ç…§åº¦ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="34">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="34" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">35</div>
                    <div class="item-text">ä½œæ¥­å ´ãƒ»åŠ å·¥å ´ãƒ»è³‡æç½®ãå ´ã®æ•´ç†æ•´é “åŠã³æ¸…æƒçŠ¶æ³ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="35">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="35" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">36</div>
                    <div class="item-text">è³‡æã®é¢¨æ•£ãƒ»å€’å£Šé˜²æ­¢å¯¾ç­–ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="36">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="36" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
                <div class="inspection-item">
                    <div class="item-no">37</div>
                    <div class="item-text">ç¬¬ä¸‰è€…ç½å®³é˜²æ­¢å¯¾ç­–ã¯è‰¯ã„ã‹ã€‚</div>
                    <select class="inspection-result" data-no="37">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="37" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
            </div>

            <!-- ãã®ä»– -->
            <div class="inspection-category">
                <h3>ãã®ä»–</h3>
                <div class="inspection-item">
                    <div class="item-no">38</div>
                    <div class="item-text">äº¤é€šãƒ«ãƒ¼ãƒ«ã‚’å®ˆã‚Šã€å®‰å…¨é‹è»¢ã‚’ã—ã¦ã„ã‚‹ã‹ã€‚</div>
                    <select class="inspection-result" data-no="38">
                        <option value="">-</option>
                        <option value="â—‹">â—‹</option>
                        <option value="â–³">â–³</option>
                        <option value="Ã—">Ã—</option>
                    </select>
                    <input type="text" class="inspection-comment" data-no="38" placeholder="æŒ‡æ‘˜äº‹é …">
                </div>
            </div>

            <!-- æŒ‡æ‘˜ã‚³ãƒ¡ãƒ³ãƒˆ -->
            <div class="inspection-category">
                <h3>æŒ‡æ‘˜ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆâ„–ãƒ»æŒ‡æ‘˜ãƒ»æ˜¯æ­£ï¼‰</h3>
                <div class="form-group">
                    <textarea id="generalComment" rows="5" placeholder="å…¨ä½“çš„ãªæŒ‡æ‘˜äº‹é …ã‚„æ”¹å–„è¦æœ›ãªã©ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„"></textarea>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <button class="btn btn-success" onclick="saveInspectionData()">ç‚¹æ¤œè¡¨ã‚’ä¿å­˜</button>
                <button class="btn btn-primary" onclick="setAllOK()">ã™ã¹ã¦â—‹</button>
                <button class="btn btn-secondary" onclick="clearInspectionForm()">ã‚¯ãƒªã‚¢</button>
            </div>
        </div>

        <!-- æœˆæ¬¡ç‚¹æ¤œç°¿ -->
        <div id="monthly" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">æœˆæ¬¡ç‚¹æ¤œç°¿</h2>
            
            <div class="filter-section">
                <div class="form-group">
                    <label>å¯¾è±¡å¹´æœˆ</label>
                    <input type="month" id="filterMonth">
                </div>
                <div class="form-group">
                    <label>å·¥äº‹å</label>
                    <select id="filterConstruction">
                        <option value="">ã™ã¹ã¦</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>å®Ÿæ–½è€…</label>
                    <select id="filterInspector">
                        <option value="">ã™ã¹ã¦</option>
                    </select>
                </div>
                <div class="form-group" style="display: flex; align-items: flex-end;">
                    <button class="btn btn-info" onclick="filterMonthlyData()" style="width: 100%;">çµã‚Šè¾¼ã¿</button>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <button class="btn btn-success" onclick="exportToJSON()">ğŸ“¥ JSONãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</button>
                <button class="btn btn-info" onclick="document.getElementById('importJSON').click()">ğŸ“¤ JSONã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
                <input type="file" id="importJSON" accept=".json" style="display: none;" onchange="importFromJSON(event)">
                <button class="btn btn-primary" onclick="printReport()">ğŸ–¨ï¸ å°åˆ·</button>
                <button class="btn btn-secondary" onclick="toggleAutoBackup()">
                    <span id="autoBackupText">ğŸ”„ è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: OFF</span>
                </button>
            </div>

            <table class="data-table" id="monthlyTable">
                <thead>
                    <tr>
                        <th>No.</th>
                        <th>ç‚¹æ¤œæ—¥</th>
                        <th>å·¥äº‹å</th>
                        <th>ç¾å ´å</th>
                        <th>å®Ÿæ–½è€…</th>
                        <th>æŒ‡æ‘˜ä»¶æ•°</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="monthlyTableBody"></tbody>
            </table>
        </div>
    </div>

    <!-- è©³ç´°è¡¨ç¤ºãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="detailModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">ç‚¹æ¤œè¡¨è©³ç´°</div>
            <div id="detailContent"></div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="printReport()">ğŸ–¨ï¸ å°åˆ·</button>
                <button class="btn btn-secondary" onclick="closeDetailModal()">é–‰ã˜ã‚‹</button>
            </div>
        </div>
    </div>

    <script>
        // ãƒ‡ãƒ¼ã‚¿ç®¡ç†
        let constructions = JSON.parse(localStorage.getItem('constructions') || '[]');
        let companies = JSON.parse(localStorage.getItem('companies') || '[]');
        let inspectors = JSON.parse(localStorage.getItem('inspectors') || '[]');
        let inspections = JSON.parse(localStorage.getItem('inspections') || '[]');
        let editingId = null;
        let autoBackupEnabled = localStorage.getItem('autoBackupEnabled') === 'true';
        let autoBackupInterval = null;

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadConstructionTable();
            loadCompanyTable();
            loadInspectorTable();
            loadMonthlyTable();
            updateSelects();
            
            // ä»Šæ—¥ã®æ—¥ä»˜ã‚’ã‚»ãƒƒãƒˆ
            document.getElementById('inspectionDate').valueAsDate = new Date();
            
            // ä»Šæœˆã‚’ã‚»ãƒƒãƒˆ
            const today = new Date();
            document.getElementById('filterMonth').value = 
                today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0');
            
            // è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—çŠ¶æ…‹ã‚’å¾©å…ƒ
            if (autoBackupEnabled) {
                startAutoBackup();
                document.getElementById('autoBackupText').textContent = 'ğŸ”„ è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: ON';
            }
        });

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            hideAlert();
        }

        // ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º
        function showAlert(message, type = 'success') {
            const alert = document.getElementById('alert');
            alert.textContent = message;
            alert.className = 'alert alert-' + type + ' show';
            
            setTimeout(() => {
                hideAlert();
            }, 3000);
        }

        function hideAlert() {
            const alert = document.getElementById('alert');
            alert.classList.remove('show');
        }

        // å·¥äº‹ãƒã‚¹ã‚¿ãƒ¼æ©Ÿèƒ½
        function saveConstruction() {
            const name = document.getElementById('constructionName').value.trim();
            const siteName = document.getElementById('siteName').value.trim();
            const location = document.getElementById('location').value.trim();
            const period = document.getElementById('period').value.trim();

            if (!name) {
                showAlert('å·¥äº‹åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const construction = {
                id: editingId || Date.now(),
                name, siteName, location, period,
                createdAt: editingId ? constructions.find(c => c.id === editingId).createdAt : new Date().toISOString()
            };

            if (editingId) {
                const index = constructions.findIndex(c => c.id === editingId);
                constructions[index] = construction;
                showAlert('å·¥äº‹æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
                editingId = null;
                document.getElementById('constructionBtnText').textContent = 'ç™»éŒ²';
            } else {
                constructions.push(construction);
                showAlert('å·¥äº‹ã‚’ç™»éŒ²ã—ã¾ã—ãŸ');
            }

            localStorage.setItem('constructions', JSON.stringify(constructions));
            loadConstructionTable();
            clearConstructionForm();
            updateSelects();
        }

        function clearConstructionForm() {
            document.getElementById('constructionName').value = '';
            document.getElementById('siteName').value = '';
            document.getElementById('location').value = '';
            document.getElementById('period').value = '';
            editingId = null;
            document.getElementById('constructionBtnText').textContent = 'ç™»éŒ²';
        }

        function editConstruction(id) {
            const construction = constructions.find(c => c.id === id);
            if (construction) {
                document.getElementById('constructionName').value = construction.name;
                document.getElementById('siteName').value = construction.siteName || '';
                document.getElementById('location').value = construction.location || '';
                document.getElementById('period').value = construction.period || '';
                editingId = id;
                document.getElementById('constructionBtnText').textContent = 'æ›´æ–°';
                
                // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
                switchTab('construction');
                document.querySelector('.tab[onclick*="construction"]').click();
            }
        }

        function deleteConstruction(id) {
            if (confirm('ã“ã®å·¥äº‹ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹?')) {
                constructions = constructions.filter(c => c.id !== id);
                localStorage.setItem('constructions', JSON.stringify(constructions));
                loadConstructionTable();
                updateSelects();
                showAlert('å·¥äº‹ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
            }
        }

        function loadConstructionTable() {
            const tbody = document.getElementById('constructionTableBody');
            const searchTerm = (document.getElementById('constructionSearch')?.value || '').toLowerCase();
            
            const filtered = constructions.filter(c => 
                c.name.toLowerCase().includes(searchTerm) ||
                (c.siteName || '').toLowerCase().includes(searchTerm)
            );

            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 40px; color: #6c757d;">ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å·¥äº‹ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            tbody.innerHTML = filtered.map((c, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${c.name}</td>
                    <td>${c.siteName || '-'}</td>
                    <td>${c.location || '-'}</td>
                    <td>${c.period || '-'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit" onclick="editConstruction(${c.id})">ç·¨é›†</button>
                            <button class="action-btn delete" onclick="deleteConstruction(${c.id})">å‰Šé™¤</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function searchConstruction() {
            loadConstructionTable();
        }

        // ä¼šç¤¾ãƒã‚¹ã‚¿ãƒ¼æ©Ÿèƒ½
        function saveCompany() {
            const name = document.getElementById('companyName').value.trim();
            const representative = document.getElementById('representative').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const address = document.getElementById('address').value.trim();

            if (!name) {
                showAlert('ä¼šç¤¾åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const company = {
                id: editingId || Date.now(),
                name, representative, phone, address,
                createdAt: editingId ? companies.find(c => c.id === editingId).createdAt : new Date().toISOString()
            };

            if (editingId) {
                const index = companies.findIndex(c => c.id === editingId);
                companies[index] = company;
                showAlert('ä¼šç¤¾æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
                editingId = null;
                document.getElementById('companyBtnText').textContent = 'ç™»éŒ²';
            } else {
                companies.push(company);
                showAlert('ä¼šç¤¾ã‚’ç™»éŒ²ã—ã¾ã—ãŸ');
            }

            localStorage.setItem('companies', JSON.stringify(companies));
            loadCompanyTable();
            clearCompanyForm();
            updateSelects();
        }

        function clearCompanyForm() {
            document.getElementById('companyName').value = '';
            document.getElementById('representative').value = '';
            document.getElementById('phone').value = '';
            document.getElementById('address').value = '';
            editingId = null;
            document.getElementById('companyBtnText').textContent = 'ç™»éŒ²';
        }

        function editCompany(id) {
            const company = companies.find(c => c.id === id);
            if (company) {
                document.getElementById('companyName').value = company.name;
                document.getElementById('representative').value = company.representative || '';
                document.getElementById('phone').value = company.phone || '';
                document.getElementById('address').value = company.address || '';
                editingId = id;
                document.getElementById('companyBtnText').textContent = 'æ›´æ–°';
                
                document.querySelector('.tab[onclick*="company"]').click();
            }
        }

        function deleteCompany(id) {
            if (confirm('ã“ã®ä¼šç¤¾ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹?')) {
                companies = companies.filter(c => c.id !== id);
                localStorage.setItem('companies', JSON.stringify(companies));
                loadCompanyTable();
                updateSelects();
                showAlert('ä¼šç¤¾ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
            }
        }

        function loadCompanyTable() {
            const tbody = document.getElementById('companyTableBody');
            const searchTerm = (document.getElementById('companySearch')?.value || '').toLowerCase();
            
            const filtered = companies.filter(c => 
                c.name.toLowerCase().includes(searchTerm)
            );

            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 40px; color: #6c757d;">ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ä¼šç¤¾ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            tbody.innerHTML = filtered.map((c, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${c.name}</td>
                    <td>${c.representative || '-'}</td>
                    <td>${c.phone || '-'}</td>
                    <td>${c.address || '-'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit" onclick="editCompany(${c.id})">ç·¨é›†</button>
                            <button class="action-btn delete" onclick="deleteCompany(${c.id})">å‰Šé™¤</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function searchCompany() {
            loadCompanyTable();
        }

        // å®Ÿæ–½è€…ãƒã‚¹ã‚¿ãƒ¼æ©Ÿèƒ½
        function saveInspector() {
            const name = document.getElementById('inspectorName').value.trim();
            const companyId = document.getElementById('inspectorCompany').value;
            const position = document.getElementById('position').value.trim();
            const contact = document.getElementById('contact').value.trim();

            if (!name) {
                showAlert('å®Ÿæ–½è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const inspector = {
                id: editingId || Date.now(),
                name, companyId, position, contact,
                createdAt: editingId ? inspectors.find(i => i.id === editingId).createdAt : new Date().toISOString()
            };

            if (editingId) {
                const index = inspectors.findIndex(i => i.id === editingId);
                inspectors[index] = inspector;
                showAlert('å®Ÿæ–½è€…æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
                editingId = null;
                document.getElementById('inspectorBtnText').textContent = 'ç™»éŒ²';
            } else {
                inspectors.push(inspector);
                showAlert('å®Ÿæ–½è€…ã‚’ç™»éŒ²ã—ã¾ã—ãŸ');
            }

            localStorage.setItem('inspectors', JSON.stringify(inspectors));
            loadInspectorTable();
            clearInspectorForm();
            updateSelects();
        }

        function clearInspectorForm() {
            document.getElementById('inspectorName').value = '';
            document.getElementById('inspectorCompany').value = '';
            document.getElementById('position').value = '';
            document.getElementById('contact').value = '';
            editingId = null;
            document.getElementById('inspectorBtnText').textContent = 'ç™»éŒ²';
        }

        function editInspector(id) {
            const inspector = inspectors.find(i => i.id === id);
            if (inspector) {
                document.getElementById('inspectorName').value = inspector.name;
                document.getElementById('inspectorCompany').value = inspector.companyId || '';
                document.getElementById('position').value = inspector.position || '';
                document.getElementById('contact').value = inspector.contact || '';
                editingId = id;
                document.getElementById('inspectorBtnText').textContent = 'æ›´æ–°';
                
                document.querySelector('.tab[onclick*="inspector"]').click();
            }
        }

        function deleteInspector(id) {
            if (confirm('ã“ã®å®Ÿæ–½è€…ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹?')) {
                inspectors = inspectors.filter(i => i.id !== id);
                localStorage.setItem('inspectors', JSON.stringify(inspectors));
                loadInspectorTable();
                updateSelects();
                showAlert('å®Ÿæ–½è€…ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
            }
        }

        function loadInspectorTable() {
            const tbody = document.getElementById('inspectorTableBody');
            const searchTerm = (document.getElementById('inspectorSearch')?.value || '').toLowerCase();
            
            const filtered = inspectors.filter(i => 
                i.name.toLowerCase().includes(searchTerm)
            );

            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 40px; color: #6c757d;">ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å®Ÿæ–½è€…ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            tbody.innerHTML = filtered.map((i, index) => {
                const company = companies.find(c => c.id == i.companyId);
                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${i.name}</td>
                        <td>${company ? company.name : '-'}</td>
                        <td>${i.position || '-'}</td>
                        <td>${i.contact || '-'}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit" onclick="editInspector(${i.id})">ç·¨é›†</button>
                                <button class="action-btn delete" onclick="deleteInspector(${i.id})">å‰Šé™¤</button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function searchInspector() {
            loadInspectorTable();
        }

        // ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹æ›´æ–°
        function updateSelects() {
            // å·¥äº‹ã‚»ãƒ¬ã‚¯ãƒˆ
            const constructionSelects = [
                document.getElementById('inspectionConstruction'),
                document.getElementById('filterConstruction')
            ];
            
            constructionSelects.forEach(select => {
                if (select) {
                    const currentValue = select.value;
                    const options = select.id === 'filterConstruction' 
                        ? '<option value="">ã™ã¹ã¦</option>' 
                        : '<option value="">é¸æŠã—ã¦ãã ã•ã„</option>';
                    
                    select.innerHTML = options + constructions.map(c => 
                        `<option value="${c.id}">${c.name}</option>`
                    ).join('');
                    
                    select.value = currentValue;
                }
            });

            // ä¼šç¤¾ã‚»ãƒ¬ã‚¯ãƒˆ
            const companySelect = document.getElementById('inspectorCompany');
            if (companySelect) {
                const currentValue = companySelect.value;
                companySelect.innerHTML = '<option value="">é¸æŠã—ã¦ãã ã•ã„</option>' +
                    companies.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
                companySelect.value = currentValue;
            }

            // å®Ÿæ–½è€…ã‚»ãƒ¬ã‚¯ãƒˆ
            const inspectorSelects = [
                document.getElementById('inspectionInspector'),
                document.getElementById('filterInspector')
            ];
            
            inspectorSelects.forEach(select => {
                if (select) {
                    const currentValue = select.value;
                    const options = select.id === 'filterInspector' 
                        ? '<option value="">ã™ã¹ã¦</option>' 
                        : '<option value="">é¸æŠã—ã¦ãã ã•ã„</option>';
                    
                    select.innerHTML = options + inspectors.map(i => 
                        `<option value="${i.id}">${i.name}</option>`
                    ).join('');
                    
                    select.value = currentValue;
                }
            });
        }

        // ç¾å ´åè‡ªå‹•å…¥åŠ›
        function updateSiteName() {
            const constructionId = document.getElementById('inspectionConstruction').value;
            const construction = constructions.find(c => c.id == constructionId);
            document.getElementById('inspectionSiteName').value = construction ? (construction.siteName || '') : '';
        }

        // ç‚¹æ¤œè¡¨ä¿å­˜
        function saveInspectionData() {
            const date = document.getElementById('inspectionDate').value;
            const constructionId = document.getElementById('inspectionConstruction').value;
            const inspectorId = document.getElementById('inspectionInspector').value;
            const generalComment = document.getElementById('generalComment').value.trim();

            if (!date || !constructionId || !inspectorId) {
                showAlert('ç‚¹æ¤œæ—¥ã€å·¥äº‹åã€å®Ÿæ–½è€…ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const results = {};
            const comments = {};
            
            document.querySelectorAll('.inspection-result').forEach(select => {
                const no = select.dataset.no;
                results[no] = select.value;
            });

            document.querySelectorAll('.inspection-comment').forEach(input => {
                const no = input.dataset.no;
                if (input.value.trim()) {
                    comments[no] = input.value.trim();
                }
            });

            const inspection = {
                id: Date.now(),
                date,
                constructionId,
                inspectorId,
                results,
                comments,
                generalComment,
                createdAt: new Date().toISOString()
            };

            inspections.push(inspection);
            localStorage.setItem('inspections', JSON.stringify(inspections));
            
            showAlert('ç‚¹æ¤œè¡¨ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            clearInspectionForm();
            loadMonthlyTable();
        }

        function clearInspectionForm() {
            document.getElementById('inspectionDate').valueAsDate = new Date();
            document.getElementById('inspectionConstruction').value = '';
            document.getElementById('inspectionInspector').value = '';
            document.getElementById('inspectionSiteName').value = '';
            document.getElementById('generalComment').value = '';
            
            document.querySelectorAll('.inspection-result').forEach(select => {
                select.value = '';
            });
            
            document.querySelectorAll('.inspection-comment').forEach(input => {
                input.value = '';
            });
        }

        // æœˆæ¬¡ç‚¹æ¤œç°¿
        function loadMonthlyTable() {
            const tbody = document.getElementById('monthlyTableBody');
            
            if (inspections.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #6c757d;">ç‚¹æ¤œè¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            tbody.innerHTML = inspections.map((insp, index) => {
                const construction = constructions.find(c => c.id == insp.constructionId);
                const inspector = inspectors.find(i => i.id == insp.inspectorId);
                const issueCount = Object.values(insp.results).filter(r => r === 'â–³' || r === 'Ã—').length;

                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${insp.date}</td>
                        <td>${construction ? construction.name : '-'}</td>
                        <td>${construction ? (construction.siteName || '-') : '-'}</td>
                        <td>${inspector ? inspector.name : '-'}</td>
                        <td>${issueCount}ä»¶</td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit" onclick="viewDetail(${insp.id})">è©³ç´°</button>
                                <button class="action-btn delete" onclick="deleteInspection(${insp.id})">å‰Šé™¤</button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function filterMonthlyData() {
            const month = document.getElementById('filterMonth').value;
            const constructionId = document.getElementById('filterConstruction').value;
            const inspectorId = document.getElementById('filterInspector').value;

            let filtered = inspections;

            if (month) {
                filtered = filtered.filter(i => i.date.startsWith(month));
            }

            if (constructionId) {
                filtered = filtered.filter(i => i.constructionId == constructionId);
            }

            if (inspectorId) {
                filtered = filtered.filter(i => i.inspectorId == inspectorId);
            }

            const tbody = document.getElementById('monthlyTableBody');
            
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #6c757d;">è©²å½“ã™ã‚‹ç‚¹æ¤œè¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            tbody.innerHTML = filtered.map((insp, index) => {
                const construction = constructions.find(c => c.id == insp.constructionId);
                const inspector = inspectors.find(i => i.id == insp.inspectorId);
                const issueCount = Object.values(insp.results).filter(r => r === 'â–³' || r === 'Ã—').length;

                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${insp.date}</td>
                        <td>${construction ? construction.name : '-'}</td>
                        <td>${construction ? (construction.siteName || '-') : '-'}</td>
                        <td>${inspector ? inspector.name : '-'}</td>
                        <td>${issueCount}ä»¶</td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit" onclick="viewDetail(${insp.id})">è©³ç´°</button>
                                <button class="action-btn delete" onclick="deleteInspection(${insp.id})">å‰Šé™¤</button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function deleteInspection(id) {
            if (confirm('ã“ã®ç‚¹æ¤œè¨˜éŒ²ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹?')) {
                inspections = inspections.filter(i => i.id !== id);
                localStorage.setItem('inspections', JSON.stringify(inspections));
                loadMonthlyTable();
                showAlert('ç‚¹æ¤œè¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
            }
        }

        // ç‚¹æ¤œé …ç›®ãƒã‚¹ã‚¿ãƒ¼
        const inspectionItems = {
            '1': 'ç·Šæ€¥é€£çµ¡å…ˆãƒ»æ•‘æ€¥ç—…é™¢ãƒ»é¿é›£å ´æ‰€ï¼ˆåœ°å›³ï¼‰ã¯ã€ç›®ç«‹ã¤å ´æ‰€ã«æ²ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '2': 'ä½œæ¥­å“¡åç°¿ãŒå…¨å“¡æå‡ºã•ã‚Œã¦ãŠã‚Šã€å†…å®¹ã«æ¼ã‚Œã¯ãªã„ã‹ã€‚',
            '3': 'å®‰å…¨è¡›ç”Ÿæ—¥èªŒï¼ˆå®‰å…¨ä½œæ¥­æŒ‡ç¤ºæ›¸ï¼‰ã®ä½œæˆãƒ»è¨˜éŒ²ç®¡ç†ã¯è‰¯ã„ã‹ã€‚',
            '4': 'ä½œæ¥­è¨ˆç”»æ›¸ãƒ»ä½œæ¥­æ‰‹é †æ›¸ã®ä½œæˆãƒ»å‘¨çŸ¥åŠã³è¨˜éŒ²ç®¡ç†ã¯è‰¯ã„ã‹ã€‚',
            '5': 'é€ã‚Šå‡ºã—æ•™è‚²ã¯ã€å®Ÿæ–½ã•ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '6': 'äº‹æ¥­ä¸»ãƒ»ä¸€äººè¦ªæ–¹ã¯ã€åŠ´ç½ä¿é™ºç‰¹åˆ¥åŠ å…¥ã‚’ã—ã¦ã„ã‚‹ã‹ã€‚',
            '7': 'å¥åº·ç®¡ç†ï¼ˆå¥åº·è¨ºæ–­ãƒ»ç†±ä¸­ç—‡äºˆé˜²å¯¾ç­–ç­‰ï¼‰ã¯è‰¯ã„ã‹ã€‚',
            '8': 'é«˜å¹´é½¢è€…ã®å°±æ¥­ç®¡ç†ãƒ»é©æ­£é…ç½®ã¯è‰¯ã„ã‹ã€‚',
            '9': 'å¹´å°‘è€…ãƒ»å¥³æ€§ã®å°±æ¥­ç®¡ç†ãƒ»é©æ­£é…ç½®ã¯è‰¯ã„ã‹ã€‚',
            '10': 'æœ‰è³‡æ ¼ä½œæ¥­ã§ã¯ã€æœ‰è³‡æ ¼è€…ãŒé©æ­£ã«é…ç½®ã•ã‚Œã¦ã€è³‡æ ¼è€…è¨¼ã‚’æºå¸¯ã—ã¦ã„ã‚‹ã‹ã€‚',
            '11': 'æœç¤¼å‚åŠ ãƒ»ç¾åœ°KYãƒ»å§‹æ¥­å‰ç‚¹æ¤œã¯å®Ÿæ–½ã—ã¦ã„ã‚‹ã‹ã€‚',
            '12': 'è„šç«‹ã®ä½¿ç”¨æ¡ä»¶ãƒ»ä½œæ¥­ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '13': 'ç«‹ã¡é¦¬ç­‰å¯æ¬å¼ä½œæ¥­å°ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '14': 'ã¯ã—ã”ã®ä½¿ç”¨æ¡ä»¶ãƒ»æ˜‡é™ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '15': 'é«˜æ‰€ä½œæ¥­è»Šãƒ»ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¿ãƒ¯ãƒ¼ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '16': 'é–‹å£éƒ¨é¤Šç”Ÿãƒ»è¡¨ç¤ºã‚„é–‹å£éƒ¨å‘¨è¾ºä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '17': 'è¶³å ´ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '18': 'ç‰æ›ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '19': 'å»ºè¨­æ©Ÿæ¢°ï¼ˆã‚¯ãƒ¬ãƒ¼ãƒ³ãƒ»ãƒãƒƒã‚¯ãƒ›ãƒ¼ç­‰ï¼‰ã®ä½¿ç”¨å±ŠåŠã³ç‚¹æ¤œç®¡ç†ã¯è‰¯ã„ã‹ã€‚',
            '20': 'æ˜å‰Šä½œæ¥­ï¼ˆãƒãƒƒã‚¯ãƒ›ãƒ¼ç­‰ï¼‰ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '21': 'ãƒ‡ã‚£ã‚¹ã‚¯ã‚°ãƒ©ã‚¤ãƒ³ãƒ€ãƒ¼ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '22': 'é«˜é€Ÿã‚«ãƒƒã‚¿ãƒ¼ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '23': 'ã­ã˜åˆ‡ã‚Šæ—‹ç›¤ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '24': 'ä¸¸ã®ã“ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '25': 'é›»å‹•ãƒ‰ãƒªãƒ«ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '26': 'ã‚¹ãƒ‘ã‚¤ãƒ©ãƒ«ã‚«ãƒƒã‚¿ãƒ¼ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '27': 'ã‚¬ã‚¹æº¶æ¥ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '28': 'ã‚¢ãƒ¼ã‚¯æº¶æ¥ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '29': 'å·¥äº‹ç”¨åˆ†é›»ç›¤å–æ‰±ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '30': 'æœ‰æ©Ÿæº¶å‰¤ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '31': 'é…¸æ¬ å±é™ºä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '32': 'çŸ³ç¶¿å–æ‰±ä½œæ¥­ã§ã®ãƒ«ãƒ¼ãƒ«ã¯å®ˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã€‚',
            '33': 'å®‰å…¨ä¿è­·å…·ã¯è¦æ ¼èªå®šå“ã§ã€ä½¿ç”¨å‰ç‚¹æ¤œã¯å®Ÿæ–½ã—ã¦ã„ã‚‹ã‹ã€‚',
            '34': 'ä½œæ¥­å ´æ‰€ãƒ»åŠ å·¥å ´ãƒ»ä½œæ¥­é€šè·¯ã®ç¢ºä¿åŠã³ç…§åº¦ã¯è‰¯ã„ã‹ã€‚',
            '35': 'ä½œæ¥­å ´ãƒ»åŠ å·¥å ´ãƒ»è³‡æç½®ãå ´ã®æ•´ç†æ•´é “åŠã³æ¸…æƒçŠ¶æ³ã¯è‰¯ã„ã‹ã€‚',
            '36': 'è³‡æã®é¢¨æ•£ãƒ»å€’å£Šé˜²æ­¢å¯¾ç­–ã¯è‰¯ã„ã‹ã€‚',
            '37': 'ç¬¬ä¸‰è€…ç½å®³é˜²æ­¢å¯¾ç­–ã¯è‰¯ã„ã‹ã€‚',
            '38': 'äº¤é€šãƒ«ãƒ¼ãƒ«ã‚’å®ˆã‚Šã€å®‰å…¨é‹è»¢ã‚’ã—ã¦ã„ã‚‹ã‹ã€‚'
        };

        // è©³ç´°è¡¨ç¤º
        function viewDetail(id) {
            const inspection = inspections.find(i => i.id === id);
            if (!inspection) return;

            const construction = constructions.find(c => c.id == inspection.constructionId);
            const inspector = inspectors.find(i => i.id == inspection.inspectorId);

            let detailHTML = `
                <div class="report-info">
                    <div class="report-info-item"><strong>ç‚¹æ¤œæ—¥:</strong> ${inspection.date}</div>
                    <div class="report-info-item"><strong>å·¥äº‹å:</strong> ${construction ? construction.name : '-'}</div>
                    <div class="report-info-item"><strong>å®Ÿæ–½è€…:</strong> ${inspector ? inspector.name : '-'}</div>
                </div>
                <div style="max-height: 400px; overflow-y: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 60px;">No.</th>
                                <th>ç‚¹æ¤œé …ç›®</th>
                                <th style="width: 80px;">çµæœ</th>
                                <th style="width: 200px;">æŒ‡æ‘˜äº‹é …</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            for (let i = 1; i <= 38; i++) {
                const result = inspection.results[i] || '-';
                const comment = inspection.comments[i] || '-';
                const resultClass = result === 'Ã—' ? 'color: #dc3545; font-weight: bold;' : 
                                   result === 'â–³' ? 'color: #ffc107; font-weight: bold;' : '';
                
                detailHTML += `
                    <tr>
                        <td style="text-align: center;">${i}</td>
                        <td>${inspectionItems[i]}</td>
                        <td style="text-align: center; ${resultClass}">${result}</td>
                        <td>${comment}</td>
                    </tr>
                `;
            }

            detailHTML += `
                        </tbody>
                    </table>
                </div>
            `;

            // å…¨ä½“ã‚³ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Œã°è¡¨ç¤º
            if (inspection.generalComment) {
                detailHTML += `
                    <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea;">
                        <strong style="color: #667eea;">æŒ‡æ‘˜ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆâ„–ãƒ»æŒ‡æ‘˜ãƒ»æ˜¯æ­£ï¼‰:</strong>
                        <div style="margin-top: 8px; white-space: pre-wrap; font-size: 14px;">${inspection.generalComment}</div>
                    </div>
                `;
            }

            document.getElementById('detailContent').innerHTML = detailHTML;
            document.getElementById('detailModal').classList.add('show');
            
            // ç¾åœ¨è¡¨ç¤ºä¸­ã®IDã‚’ä¿å­˜
            window.currentPrintInspectionId = id;
        }

        function closeDetailModal() {
            document.getElementById('detailModal').classList.remove('show');
            window.currentPrintInspectionId = null;
        }

        // Excelã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆç°¡æ˜“ç‰ˆï¼‰
        function exportToExcel() {
            showAlert('Excelå‡ºåŠ›æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™', 'error');
        }

        // å°åˆ·
        function printReport() {
            // è©³ç´°è¡¨ç¤ºãƒ¢ãƒ¼ãƒ€ãƒ«ã‹ã‚‰å°åˆ·ã™ã‚‹å ´åˆ
            if (window.currentPrintInspectionId) {
                printInspectionDetail(window.currentPrintInspectionId);
            } else {
                // é€šå¸¸ã®æœˆæ¬¡ä¸€è¦§å°åˆ·
                window.print();
            }
        }

        // ç‚¹æ¤œè¡¨è©³ç´°ã®å°åˆ·
        function printInspectionDetail(id) {
            const inspection = inspections.find(i => i.id === id);
            if (!inspection) return;

            const construction = constructions.find(c => c.id == inspection.constructionId);
            const inspector = inspectors.find(i => i.id == inspection.inspectorId);

            // ã‚«ãƒ†ã‚´ãƒªå®šç¾©ï¼ˆ2åˆ—ã«åˆ†å‰²ï¼‰
            const leftCategories = [
                { name: 'å®‰å…¨è¡›ç”Ÿç®¡ç†ä½“åˆ¶', start: 1, end: 11 },
                { name: 'å¢œè½ãƒ»è»¢è½ãƒ»é£›æ¥è½ä¸‹ç½å®³', start: 12, end: 18 },
                { name: 'é‡æ©Ÿç½å®³', start: 19, end: 20 }
            ];

            const rightCategories = [
                { name: 'é›»å‹•å·¥å…·ç½å®³', start: 21, end: 26 },
                { name: 'ç«ç½ãƒ»æ„Ÿé›»ç½å®³', start: 27, end: 29 },
                { name: 'å±é™ºæœ‰å®³ä½œæ¥­', start: 30, end: 32 },
                { name: 'è¦å¾‹ãƒ»è¡›ç”Ÿç®¡ç†', start: 33, end: 37 },
                { name: 'ãã®ä»–', start: 38, end: 38 }
            ];

            // å°åˆ·ç”¨HTMLã‚’ç”Ÿæˆ
            let printHTML = `
                <!DOCTYPE html>
                <html lang="ja">
                <head>
                    <meta charset="UTF-8">
                    <title>å®‰å…¨ãƒ‘ãƒˆãƒ­ãƒ¼ãƒ«ç‚¹æ¤œè¡¨</title>
                    <style>
                        @page {
                            size: A3 portrait;
                            margin: 15mm 10mm 10mm 10mm;
                        }
                        body {
                            font-family: 'MS PGothic', 'Yu Gothic', sans-serif;
                            font-size: 9pt;
                            margin: 0;
                            padding: 0;
                            display: flex;
                            justify-content: center;
                            align-items: center;
                            min-height: 100vh;
                        }
                        .page-container {
                            max-width: 1100px;
                            margin: auto;
                        }
                        .print-title {
                            text-align: center;
                            font-size: 16pt;
                            font-weight: bold;
                            margin-bottom: 8px;
                            border-bottom: 3px solid #000;
                            padding-bottom: 4px;
                        }
                        .print-header {
                            margin-bottom: 8px;
                        }
                        .print-header table {
                            width: 100%;
                            border-collapse: collapse;
                            font-size: 10pt;
                        }
                        .print-header td {
                            padding: 5px 8px;
                            border: 1px solid #000;
                        }
                        .print-header .label {
                            background-color: #e0e0e0;
                            font-weight: bold;
                            width: 80px;
                            text-align: center;
                        }
                        .two-column {
                            display: flex;
                            gap: 8px;
                            margin-bottom: 8px;
                        }
                        .column {
                            flex: 1;
                        }
                        .print-table {
                            width: 100%;
                            border-collapse: collapse;
                            font-size: 9pt;
                            margin-bottom: 3px;
                        }
                        .print-table th,
                        .print-table td {
                            border: 1px solid #000;
                            padding: 5px 6px;
                            line-height: 1.5;
                        }
                        .print-table th {
                            background-color: #e0e0e0;
                            font-weight: bold;
                            text-align: center;
                            font-size: 9pt;
                            padding: 6px;
                        }
                        .category-header {
                            background-color: #c0c0c0;
                            font-weight: bold;
                            text-align: center;
                            padding: 5px !important;
                            font-size: 9.5pt;
                        }
                        .item-no {
                            text-align: center;
                            width: 30px;
                            font-weight: bold;
                        }
                        .item-text {
                            font-size: 8.5pt;
                            line-height: 1.5;
                            padding: 4px 6px !important;
                        }
                        .item-result {
                            text-align: center;
                            width: 35px;
                            font-weight: bold;
                            font-size: 9pt;
                        }
                        .item-comment {
                            width: 25%;
                            font-size: 8pt;
                            padding: 4px 5px !important;
                        }
                        .result-ng { color: #d00; }
                        .result-warn { color: #f80; }
                        .bottom-section {
                            display: flex;
                            gap: 8px;
                            margin-top: 8px;
                        }
                        .comment-section {
                            flex: 1;
                            border: 1px solid #000;
                            padding: 6px 8px;
                            background-color: #fafafa;
                        }
                        .comment-title {
                            font-weight: bold;
                            font-size: 9pt;
                            margin-bottom: 4px;
                            border-bottom: 1px solid #666;
                            padding-bottom: 2px;
                        }
                        .comment-content {
                            font-size: 8.5pt;
                            line-height: 1.5;
                            white-space: pre-wrap;
                            min-height: 40px;
                        }
                        .signature-area {
                            display: flex;
                            flex-direction: column;
                            gap: 6px;
                        }
                        .signature-box {
                            border: 1px solid #000;
                            padding: 5px 8px;
                            text-align: center;
                            width: 110px;
                        }
                        .signature-label {
                            font-size: 8.5pt;
                            font-weight: bold;
                            margin-bottom: 4px;
                        }
                        .signature-stamp {
                            width: 70px;
                            height: 50px;
                            border: 1px dashed #999;
                            margin: 3px auto;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: #ccc;
                            font-size: 7pt;
                        }
                    </style>
                </head>
                <body>
                    <div class="page-container">
                    <div class="print-title">å®‰å…¨ãƒ‘ãƒˆãƒ­ãƒ¼ãƒ«ç‚¹æ¤œè¡¨</div>
                    
                    <div class="print-header">
                        <table>
                            <tr>
                                <td class="label">ç‚¹æ¤œæ—¥</td>
                                <td style="width: 18%;">${inspection.date}</td>
                                <td class="label">å·¥äº‹å</td>
                                <td style="width: 35%;">${construction ? construction.name : '-'}</td>
                                <td class="label">ç¾å ´å</td>
                                <td style="width: 30%;">${construction ? (construction.siteName || '-') : '-'}</td>
                            </tr>
                        </table>
                    </div>

                    <div class="two-column">
                        <div class="column">
                            <table class="print-table">
                                <thead>
                                    <tr>
                                        <th class="item-no">No</th>
                                        <th>ç‚¹æ¤œé …ç›®</th>
                                        <th class="item-result">åˆ¤å®š</th>
                                        <th class="item-comment">æŒ‡æ‘˜</th>
                                    </tr>
                                </thead>
                                <tbody>
            `;

            // å·¦åˆ—ã®ã‚«ãƒ†ã‚´ãƒªã‚’ç”Ÿæˆ
            leftCategories.forEach(category => {
                printHTML += `<tr><td colspan="4" class="category-header">${category.name}</td></tr>`;
                for (let i = category.start; i <= category.end; i++) {
                    const result = inspection.results[i] || '-';
                    const comment = inspection.comments[i] || '';
                    const resultClass = result === 'Ã—' ? 'result-ng' : result === 'â–³' ? 'result-warn' : '';
                    printHTML += `
                        <tr>
                            <td class="item-no">${i}</td>
                            <td class="item-text">${inspectionItems[i]}</td>
                            <td class="item-result ${resultClass}">${result}</td>
                            <td class="item-comment">${comment}</td>
                        </tr>
                    `;
                }
            });

            printHTML += `
                                </tbody>
                            </table>
                        </div>
                        <div class="column">
                            <table class="print-table">
                                <thead>
                                    <tr>
                                        <th class="item-no">No</th>
                                        <th>ç‚¹æ¤œé …ç›®</th>
                                        <th class="item-result">åˆ¤å®š</th>
                                        <th class="item-comment">æŒ‡æ‘˜</th>
                                    </tr>
                                </thead>
                                <tbody>
            `;

            // å³åˆ—ã®ã‚«ãƒ†ã‚´ãƒªã‚’ç”Ÿæˆ
            rightCategories.forEach(category => {
                printHTML += `<tr><td colspan="4" class="category-header">${category.name}</td></tr>`;
                for (let i = category.start; i <= category.end; i++) {
                    const result = inspection.results[i] || '-';
                    const comment = inspection.comments[i] || '';
                    const resultClass = result === 'Ã—' ? 'result-ng' : result === 'â–³' ? 'result-warn' : '';
                    printHTML += `
                        <tr>
                            <td class="item-no">${i}</td>
                            <td class="item-text">${inspectionItems[i]}</td>
                            <td class="item-result ${resultClass}">${result}</td>
                            <td class="item-comment">${comment}</td>
                        </tr>
                    `;
                }
            });

            printHTML += `
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bottom-section">
                        <div class="comment-section">
                            <div class="comment-title">æŒ‡æ‘˜ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆâ„–ãƒ»æŒ‡æ‘˜ãƒ»æ˜¯æ­£ï¼‰</div>
                            <div class="comment-content">${inspection.generalComment || 'ç‰¹è¨˜äº‹é …ãªã—'}</div>
                        </div>
                        <div class="signature-area">
                            <div class="signature-box">
                                <div class="signature-label">å®Ÿæ–½è€…ç¢ºèª</div>
                                <div class="signature-stamp">æŠ¼å°</div>
                            </div>
                            <div class="signature-box">
                                <div class="signature-label">äº‹æ¥­ä¸»é–¢ä¿‚è€…ç¢ºèª</div>
                                <div class="signature-stamp">æŠ¼å°</div>
                            </div>
                        </div>
                    </div>
                    </div>
                </body>
                </html>
            `;

            // æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§å°åˆ·
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printHTML);
            printWindow.document.close();
            printWindow.focus();
            
            // å°åˆ·ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
            setTimeout(() => {
                printWindow.print();
                printWindow.onafterprint = () => printWindow.close();
            }, 500);
        }

        // ã™ã¹ã¦â—‹æ©Ÿèƒ½
        function setAllOK() {
            if (confirm('ã™ã¹ã¦ã®ç‚¹æ¤œé …ç›®ã‚’ã€Œâ—‹ã€ã«è¨­å®šã—ã¾ã™ã‹ï¼Ÿ')) {
                document.querySelectorAll('.inspection-result').forEach(select => {
                    select.value = 'â—‹';
                });
                showAlert('ã™ã¹ã¦ã®é …ç›®ã‚’â—‹ã«è¨­å®šã—ã¾ã—ãŸ');
            }
        }

        // JSONãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
        function exportToJSON() {
            const backupData = {
                version: '1.0',
                exportDate: new Date().toISOString(),
                data: {
                    constructions: constructions,
                    companies: companies,
                    inspectors: inspectors,
                    inspections: inspections
                }
            };

            const dataStr = JSON.stringify(backupData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            const dateStr = new Date().toISOString().slice(0, 10).replace(/-/g, '');
            link.download = `å®‰å…¨ãƒ‘ãƒˆãƒ­ãƒ¼ãƒ«ç‚¹æ¤œè¡¨_ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—_${dateStr}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showAlert('JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ');
        }

        // JSONã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        function importFromJSON(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    
                    if (!backupData.data) {
                        throw new Error('ç„¡åŠ¹ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™');
                    }

                    if (confirm('ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                        constructions = backupData.data.constructions || [];
                        companies = backupData.data.companies || [];
                        inspectors = backupData.data.inspectors || [];
                        inspections = backupData.data.inspections || [];

                        localStorage.setItem('constructions', JSON.stringify(constructions));
                        localStorage.setItem('companies', JSON.stringify(companies));
                        localStorage.setItem('inspectors', JSON.stringify(inspectors));
                        localStorage.setItem('inspections', JSON.stringify(inspections));

                        loadConstructionTable();
                        loadCompanyTable();
                        loadInspectorTable();
                        loadMonthlyTable();
                        updateSelects();

                        showAlert('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
                    }
                } catch (error) {
                    showAlert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
            
            // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã‚’ãƒªã‚»ãƒƒãƒˆ
            event.target.value = '';
        }

        // è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—åˆ‡ã‚Šæ›¿ãˆ
        function toggleAutoBackup() {
            autoBackupEnabled = !autoBackupEnabled;
            localStorage.setItem('autoBackupEnabled', autoBackupEnabled);
            
            if (autoBackupEnabled) {
                startAutoBackup();
                document.getElementById('autoBackupText').textContent = 'ğŸ”„ è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: ON';
                showAlert('è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’æœ‰åŠ¹ã«ã—ã¾ã—ãŸï¼ˆ5åˆ†ã”ã¨ï¼‰');
            } else {
                stopAutoBackup();
                document.getElementById('autoBackupText').textContent = 'ğŸ”„ è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: OFF';
                showAlert('è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ç„¡åŠ¹ã«ã—ã¾ã—ãŸ');
            }
        }

        // è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—é–‹å§‹
        function startAutoBackup() {
            // æ—¢å­˜ã®ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢
            if (autoBackupInterval) {
                clearInterval(autoBackupInterval);
            }
            
            // 5åˆ†ã”ã¨ã«è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
            autoBackupInterval = setInterval(() => {
                autoBackupToLocalStorage();
            }, 5 * 60 * 1000); // 5åˆ†
        }

        // è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—åœæ­¢
        function stopAutoBackup() {
            if (autoBackupInterval) {
                clearInterval(autoBackupInterval);
                autoBackupInterval = null;
            }
        }

        // LocalStorageã«è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
        function autoBackupToLocalStorage() {
            const backupData = {
                version: '1.0',
                backupDate: new Date().toISOString(),
                data: {
                    constructions: constructions,
                    companies: companies,
                    inspectors: inspectors,
                    inspections: inspections
                }
            };
            
            localStorage.setItem('autoBackup', JSON.stringify(backupData));
            console.log('è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†:', new Date().toLocaleString());
        }
    </script>
</body>
</html>
